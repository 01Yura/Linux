shift + ctrl + 6 - если ввел не то и начался поиск доменного имени

Кадр Ethernet II, также известный как Ethernet DIX (Digital, Intel, Xerox), является наиболее широко используемым форматом Ethernet-кадра в современных сетях. Вот подробное описание структуры кадра Ethernet II, включая название, назначение и длину каждого поля:

1. **Преамбула (Preamble)**
   - **Длина:** 7 байтов (56 бит)
   - **Назначение:** Используется для синхронизации передающего и принимающего устройств. Содержит чередующуюся последовательность битов 1 и 0 (например, `10101010`), которая позволяет устройствам синхронизироваться перед передачей данных.

2. **Стартовый разделитель кадра (Start Frame Delimiter, SFD)**
   - **Длина:** 1 байт (8 бит)
   - **Назначение:** Указывает на конец преамбулы и начало данных. Значение этого поля — `10101011`, которое сигнализирует, что следующий байт — это начало кадра.

3. **MAC-адрес назначения (Destination MAC Address)**
   - **Длина:** 6 байтов (48 бит)
   - **Назначение:** Содержит MAC-адрес устройства, которому адресован кадр. Этот адрес должен быть уникальным для каждого устройства в сети.

4. **MAC-адрес источника (Source MAC Address)**
   - **Длина:** 6 байтов (48 бит)
   - **Назначение:** Содержит MAC-адрес устройства, которое отправляет кадр.

5. **Тип/Длина (Type/Length)**
   - **Длина:** 2 байта (16 бит)
   - **Назначение:** В Ethernet II это поле обычно используется для обозначения типа верхнего протокола (например, `0x0800` для IPv4, `0x0806` для ARP). Иногда его также называют "EtherType". В других вариантах Ethernet это поле может указывать длину поля данных.

6. **Поле данных (Payload/Data Field)**
   - **Длина:** От 46 до 1500 байтов
   - **Назначение:** Содержит передаваемые данные. Длина этого поля может варьироваться, но минимальный размер — 46 байтов, максимальный — 1500 байтов. Если длина данных меньше 46 байтов, то добавляется "набивка" (padding) для достижения минимального размера.

7. **Контрольная сумма кадра (Frame Check Sequence, FCS)**
   - **Длина:** 4 байта (32 бита)
   - **Назначение:** Используется для проверки целостности данных. Применяется алгоритм CRC-32 (циклический контрольный код), который позволяет обнаружить ошибки, возникшие во время передачи.

Это общая структура кадра Ethernet II. Различные расширения или варианты Ethernet могут иметь дополнительные поля или различия в структуре, но описанная выше структура является основной для классического Ethernet.

Пинг с компа 192.168.1.1 на комп 192.168.1.2 через новый свич, при пустых ARP таблицах на компах и пустой mac-table на свиче

- ПК1 планирует отослать пинг, зная то что адрес назначения в его сети (если не в своей сети, то он отправил бы его на мак дефолт гейтвея), когда пакет с 3г уровня спускается на второй, то комп проверяет соответствие Ip адреса и мак адреса в своей ARP таблице, но не находит соответствия, поэтому в действие вступает ARP протокол. Он буферизирует этот первый ICMP пакет, и отправляет броадкаст ARP запрос в сеть (кто с таким ip адресом, скажи свой mac). Этот ARP пакет уходит на свич. 
- Свич получает пакет, и добавляет мак адрес источника в свою mac таблицу (соответсвие мака и порта), и  рассылает полученный ARP кадр на все порты. 
- ПК2 получает кадр и добавляет данные в свою ARP таблицу и отправляет ARP ответ
- свич просто форвардит этот кадр на порт за которым находится ПК1, добавляя мак ПК2 в свою мак-таблицу
- кадр доходит до ПК1, он добавляет ip адрес ПК2 в свою ARP таблицу, ICMP пакет достается из буфера и уже имея соответсвие mac - ip в ARP таблице, формирует кадр и отправляет его на мак ПК2
- ПК2 получает кадр, декапсулирует его, видит что это пинг и отвечает на пинг

router> - user EXEC exec mode (router - its devise name) (in this mode you cant do any changes to config)

enable
router# - privileged EXEC mode (PEM)

? - to view available commands

configure terminal - global configuration mode (GCM)
router(config)
enable password CCNA - to protect priv EXEC mode with a password CCNA
Если заданы обе команды и enable password и enable secret, то password будет игнорироваться

running config - active config
startup config - конфиг при загрузке
show running-config - показать текущую конфигурация (PEM)
show startup-config

write / write memory / copy running-config startup-config - сохранить конфиг

service password-encryption

enable secret Cisco - второй метод это использование секрета (это так же пароль на Privileged EXEC mode)
Если заданы обе команды и enable password и enable secret, то password будет игнорироваться

router(config)# do show run - частица do позвляет выполнить команду PEM в режиме GCM 

no команда - отмена команды

show mac address-table
clear mac address-table dynamic


        Назанчение ip адреса интерфейсу

show ip interface brief
По умолчанию на роутерах интерфейсы отключены

interface GigabitEthernet 0/0 - войти в режим конфигурации интерфейсов (in g0/0)
ip address 192.168.0.1 225.255.255.0
no shutdown

show interfaces status - данная команда работает только на свичах

show interfaces - показать инфу и ошибки всех интерфейсов

show interfaces g0/0 - инфа о интерфейсе и ошибки
show interfaces description
description ## to SW1 ## - чтобы внести свое описание для интерфейса

Если вы в режиме (config-if), то чтобы выйти в PEM можно не нажимать дважды exit, а один раз нажать end 

в режиме (config-if) нажать speed и выбрать скорость
speed
duplex

interface range f0/5 - 12

ping 192.168.1.1 size 10000 - указать размер пакета
ping 192.168.1.1 size 10000 df-bit - указать что нельзя фрагментировать

                Routing

show ip route
ip route адрес маска некст-хоп - чтобы задать маршрут
ip route адрес маска g0/0 - чтобы звдвть маршрут через интерфейс
или
ip route адрес маска g0/0 некст-хоп
ip route 0.0.0.0 0.0.0.0 некст-хоп - для default gateway

mac-address МАК - указать свой мак на интерфейс

                Классовая адресация

Вот основные классы адресации:

	•	Класс A: Диапазон от 0.0.0.0 до 127.255.255.255. Сеть определена первым октетом (8 бит), оставшиеся 24 бита используются для адресации внутри сети. Всего можно создать 128 сетей класса A, каждая из которых может содержать до 16 миллионов хостов.
	•	Класс B: Диапазон от 128.0.0.0 до 191.255.255.255. Первые 16 бит (два октета) определяют сеть, остальные 16 бит — адреса внутри сети. Доступно 16,384 сети класса B, каждая может содержать до 65,536 хостов.
	•	Класс C: Диапазон от 192.0.0.0 до 223.255.255.255. Первые 24 бита определяют сеть, последние 8 бит — адреса внутри сети. Это позволяет создавать 2,097,152 сети класса C, каждая из которых может содержать до 256 хостов.
	•	Класс D: Диапазон от 224.0.0.0 до 239.255.255.255. Этот класс предназначен для мультикастинга.
	•	Класс E: Диапазон от 240.0.0.0 до 255.255.255.255. Используется для экспериментальных целей и резервирования.


                CIDR

Безклассовая адресация. Мы не используем устаревший способ деления всего адресного пространства IP4 на сети 5 классов, а делаем эти классы сами.
Это назвется subnetting

2n-2, где n-кол-во бит отведенное под хост - сколько хостов в сети
2n, где n-кол-во бит занятое дополнительно после точки под сеть - сколько возможно создать сетей


/25     2сети   126хостов
/26     4       62
/27     8       30
/28     16      14
/29     32      6
/30     64      2
/31     128     0(2)
/32     256     0(1)


FLSM - когда делишь сеть на одинакового размера сети (fix lenght)
VLSM - veriable lenght , когда делишь на неодинаковые подсети, начинать надо с большей обязательно

                        VLAN

show vlan brief
interface range g0/1 - 3
switchport mode access - по идее они и так уже являются access портами, но лучше указать это явно еще раз
switchport access vlan10
Эти команды сразу и создадут ыиланы тоже, даже если их нет 

Но чтобы создать вилан:
vlan 10
name ИМЯ_ВИЛАНА

        ТРАНК

НА СВИЧЕ:
int g0/0
switchport trunk encapsulation dot1q - данную команду надо ввожить на свичах поддерживающих устаревший ISL (проприетарный протокол), такм образом мы говорим в каком режиме рабоать транку
switchport mode trunk
show interfaces trunk - посмотреть инфу о транке
Кадры, которым разрешено ходить через интерфейс указан в том числе в графе 
Vlans allowed and active in management domain

switchport trunk allowed vlan ? - указываем кадры каких вланов будут ходить через этот интерфейс
Если на другой стороне кабеля есть влан с которым мы будем напрямую (без роутера) связываться (то есть у нас такой же вилан), то надо указать на нашей стороне интерфейса это влан, чтобы кадр придя от нас с нашим номером влана смог пройти через этот интерфейс

switchport trunk native vlan номер_влана - надо менять с дефолтного для безопасности ??? (1001)

НА РОУТЕРЕ: (ROAS)
включить основной интерфейс g0/0
interface g0/0.10
encapsulation dot1q 10(номер влана) - привязываем сабинтерфейс к влану
ip address адрес маска
sh ip int br 

                Настройка Native vlan на роутере: (необязательно)
На всех транк интерфейсах свичей native vlan должен быть одинаковый (switchport trunk native vlan 10)

1) При настройки сабинтерфейса пометить 10 влан как нейтив
   int g0/0.10
   encapsulation dot1q 10 native
   ip add адрес маска

2) Удалить сабинтерФЕЙС ЕСЛИ ОН БЫЛ и выплнить команду
   int g0/0
   ip address адрес маска


Multilayer switch

НА РОУТЕРЕ:
- удалить все виртуальные интерфейсы 
no interface g0/0.10 и тогда
- default interface g0/0 - восстановить настройки по умолчанию
- sh ip int br (удаленные сабинтерфейсы остануться в выводе пока мы не перезагрузим роутер)
int g0/0
ip add 192.168.1.194 255.255.255.252 (маска 32) - 

НА СВИЧЕ:
default int g0/1
ip routing - включаем роутинг на свиче (чтобы создать routing table на свиче 3го уровня сначала нужно включить роутинг)
no switchport - меняет принцип работы порта с 2 уровня на 3й
ip add 192.168.1.193 255.255.255.252
sh ip int br

ip route 0.0.0.0 0.0.0.0 192.168.1.194
sh ip route
sh int status (в колонке влан порт будет routed)

int vlan10 - создаем вирт интерфейс (SVI) для каждого из виланов
ip address 192.168.1.62 255.255.255.192
no shutdown

                DTP (dynamic tunking protocol)

Позволяет автоматически синхронизироыать смотрящие друг на друга порты свича CISCO, или access или trunk
show interfaces g0/0 switchport - показывет в каком режиме настроен порт
switchport nonegotiate - порт перестает отправляь DTP кадры
Перевод порта в access mode выключает DTP, но перевод порта в trunk mode - нет. 
По умолчанию транки на cisco имеют режим:
switchport trunk encapsulation negotiate 
поэтому прежде чем включить режим транк на порту, надо принудительно указать режим работы dot1q, иначе включится режим ISL, так как он в цисках имеет приоритетный выбор

DTP в целях безопасности надо откоючать и устанавливать все руками
switchport mode dynamic AUTO/DESIRABLE - это как раз и есть DTP. Desirable устанавливает транк или access с любым, прибитsv гвоздями, auto - только если второй приьит гвоздями, два auto смотрящих друг на друга - access

На старых свичах по умолчанию порты в режиме (administrative mode):
switchport mode dynamic desirable
На новых:
switchport mode dynamic auto

switchport nonegotiate - отключить DTP на конкретном порту



                VTP (VLAN trunking protocol)

Свич сервер рассылает кадры VTP по транк портвм, синхронизируя вланы на всех свичах сети, которые в режиме сервер или клиент, но не в прозрачном режиме (только передача кадров VTP)
Они смотрят значение номера ревизии, и если он больше текущего, то обновляют свою таблицу вланов

show vtp status - показывает используемую версию, домнное имя, ревизию изменений вланов, кол-во вланов и режим работы свича (сервер, клиент, прозрачный)
По умолчанию свичи находятся в режиме server
Чтобы VTP работал обязательно надо указать доменное имя VTP
VTP версий 1 и 2 не поддерживают расширенный диапазон VLAN

vtp domain имя - установть доменное имя
Если свич вне домена получает VTP кадр, то он устанавливает себе имя домена и обновляет VLAN таблицу, если ревизия выше чем его

Опвсность!!: если к существующей сети подключить какой то старый свич с ревизией выше, то он затрет все VLANы у свичей и будет проблема

vtp mode server/client/transparent
В клиентсокм режиме нельзя создавать/удалять VLANы
ЧТобы сбросить ревизию надо изменить на неиспользуемый домен, или вклчить прозрачный режим

vtp version 2 - сменить режим VTP (VTP 2 поддерживает token ring  можно его не использовать)

                Spanning tree (STP) (протокол связующего дерева)

Как работает:
1) Сначала блокирует все порты и рассылает кадры BPDU
2) Определяет центральный свич (если свич получил BPDU с более меньшим bridge ID, то он сдает позицию и больше не является root bridgом). После схождения  (converge) топологии только root bridge рассылает BPDU, остальные только принимают
3) Определяет как с каждого свича лучше добраться до центрального и данный порт разблокируется, а если есть второй порт то он остается заблокированным

1) Как выбирается root коммутатор:
По наименьшему bridge ID (свич становится root bridge) - все порты на этом свиче разблокируются (состояние forwarding ports) (их роль - designated ports, это одна из ролей портов в STP)
Bridge ID состоит из 2х полей :
- bridge priority (16бит) - по умолч 32768 (можно менять на число 4096)
- mac address - если у всех свичей одинаковый bridge priority, то root bridge свич выбирается по наименьшему мак адресу (сравнивать цифры надо слева направо)

Порты к которым подсоединены конечные устройства тоже разблокируются и не участвуют в передачи кадров BPDU (Bridge PDU)

Если есть виланы, то root bridge свич выбирается для каждого влана и это могут быть разные свичи

 2) Далее каждый из не root свичей выбирает один порт, который называется root port и с которого наименьшая стоимоть пути (root path cost) до root bridgа
 Считать надо cost только исходящего интерфейса, не принимающего
 Каждый свич отсылает BPDU со значением cost своего интерфеса в сумме с costом всех исходящих интерфейсов через которые проходил кадр BPDU, отправленный root bridgом на противоположный интерфейс свича соседа. Таким образом сосед узнает стоимость пути через данный интерфейс 
 10 Mbps - 100
 100 Mbps - 19
 1Gbps - 4
 10Gbps - 2

Если свич соединен двумя линками с разными соседями с одинаковой стоимотью, то root портом становится порт соединенный с соcедом с наименьшим sender bridge ID (как считать bridge ID указано выше)
Если свич соединен с соседом двумя одинаковыми линками, то вибирается линк с соседом у которого порт с наименьшим sender port ID (priority number) (команда для просмотра этих номеров - show spanning-tree)

3) Разблокируется (designated) порт у свича с наименьшим cost до root bridga, если cost одинаковый, то на свиче с наименьшим bridge ID
Порт у оставшегося свича остается заблокированным (non-designated or blocking or alternate port)

show spanning-tree - общая инфа по spanning-tree
show spanning-tree detail - по каждому интерфейсу

Cостояния интерфейсов:

Blocking - не принимают и дропают сетевой трафик, но принимают BPDU. Не пересылают BPDU и NOT learn mac-addresses

Listening - в этом состоянии находятся root and designated ports.
15 cек, согласно forward delay
Не принимают трафик, просто получают и пересылают BPDU

Learning - состояние после Listening
15 сек 
Не принимают трафик, просто получают и пересылают BPDU
Но в этом состоянии порт LEARN mac-addresses!

Forwarding - работает нормально

Spanning tree timers

Hello - 2сек
Forward delay - 15+15сек=30
Max age - как долго свич ждет BPDU если он перестал их получать. После этого свич считает что сосед отвалился и перестраивается топология.

Версии
PVST - работает только с ISL инкапсуляцией
PVST+ - работает с 802.1q

Regular STP использует мак назанчения 0180.с200.0000
PVST+ - 01:00:0c:cc:cc:cd

        STP Toolkit

Portfast - включается на порту соединенному c хостом
Позволяет портам немедленно перейти в режим forwarding, минуя Listening and Learning
spanning-tree portfast
spanning-tree portfast default - вклбючает портфаст на всех access портах

BPDU Guard - включенный режим на порту похволяет автоматически отключить интерфейс, при получении BPDU кадра на этот порт
spanning-tree bpduguard enable - надо выполнять в настройках интерфейса
spanning-tree portfast bpduguard default - включает BPDU guard на всех интерфейсах, где включен portfast

Root Guard - если интерефейс получил BPDU с superior (lower bridge ID), то он отклоняется и свич остается root bridgем
Интерфейс отключается

Loop guard - даже если интерфейс перестал получать BPDU, то он остается выключенным

spanning-tree mode mst/pvst/rapid-pvst

spanning-tree vlan 1 root primary - установить свич рутом
spanning-tree vlan 1 root secondary

spanning-tree vlan1 cost/port-priority

        Виды STP

Согласно IEEE                   Согласно Cisco

1) STP (802.1D)                 PVST+
оригинальный стп                с вланами
без вланов

2) RSTP (802.1W)                Rapid PVST+       
быстрее
без влвнов

3) Multiple STP
может обьединять вланы группами в инстансы

Чтобы включить режим edge порт для порта соединенного с конечным хостом:
spanning-tree portfast

                        Etherchannel Load-Balancing
                        Агрегация каналов 

Позволяет обьединить несколько физических интерфейсов в однин логичесикй, тес асмым повысим bandwith



show etherchannel load-balance - посмотреть настройку (какой именно метод балансировки используется)
например если указан src-mac, то это значит, что все кадры с одного мака будут использовать только один интерфейс
port-channel load-balance ? - посмотреть варианты настройки etherchannel и назначить нужный 

3 метода:
1) PAgP (port aggregation protocol)
Это проприетарный цисковскй протокол
2) LACP (link aggregation control protocol) - IEEE 802.3ad
3) Static EtherChannel - руками, протокол не используется
Можно обьединть до 16 интерфейсов, при 8 активных одновременно

Настройка:
- выбрать диапазон портов
- no switchport (!! только если будем делать layer 3 etherchannel)
- channel-group 1 mode РЕЖИМ 
        Режимы:
        -auto или desireble для PAgP
        -active или passive для LACP
        -on - без использования протокола (вручную)
- если сделали layer 3, то назначаем ip адрес на port-channel 1

 команды:

channel-protocol ? - но эта команда не особо нужна, так при выборе режима настройки etherchannel все равно будет использован тот или иной протокол. Но если сначала указать протокол, как в этом случае, а затем channel-group 1 mode РЕЖИМ (указать не верный режим), то эта последняя команда будет игнорирована. 

Внимание! После настройки port-channel 1 транк нужно вешать на нее, а не на физический интерфейс

show etherchannel summary 
show etherchannel port-channel 

                Dynamic routing protocols

IGP (interior gateway protocol) - distance vector algoritm (RIP and EIGRP) and link state (OSPF and IS-IS)

EGP (exterior gateway protocol) - BGP использует Path vector algoritm 

RIP (использует hop count в качестве метрики) и EIGRP (bandwidth and delay) сообщают соседу только метрику, но не стоимость пути
А OSPF сообщает полную картину сети соседу 

Если до сети назначения можно добраться двумя путями и метрика этих путей одинакова, то в таблицу маршрутизации будут добавлены 2 пути и для отправки трафика будут использоваться оба пути. Это называется ECMP load-balancing (equal cost multipath)
То же самое можно сделать если указать 2 статических маршрута до сети (статические маршруты не используют понятие метрики [1/0])
[110/2] - административная дистанция и метрика
AD используется для того, чтобы определить какой маршрут более заслуживает доверия (trustworthly)

Route protocol/type     AD

directly connected      0
static                  1
eBGP                    20
EIGRP                   90
IGRP (старая версия)    100
OSPF                    110
IS-IS                   115
RIP                     120
EIGRP(external)         170
iBGP                    200
unusable route          255

                        RIP

Как метрику использует hop, bandwidth не важен
Максимум 15 хопов
Rip1 (только классовая адресация, броадкаст для рассылки 255.255.255.255), Rip2 (мультикаст для расылки 224.0.0.9), RipNg (для IPv6)
2 типа сообщение : request and response (каждые 30 сек)

router rip - включаем рип
version 2
no auto-summary - отключить классовцю адресация, которая стоит по умолчанию
network 10.0.0.0 - ищет все интерфейсы которые входят в указанный диапазон 10.0.0.0/8 (например 10.0.1.0/30) и строит смежность с соседями на этих интерфейсах, сообщая префикс сети на данном интерфейче и свою таблицу маршрутизации
network 172.16.0.0
Если за интерфейсом нет соседей, то надо вкл пассивный режим на нем 
passive-interface g0/2 - таким образом мы говорим роутеру не отсылать RIP сообщения через этот интерфейс, но инфа о данной сети продолжает рассылаться по соседям за другими интерфейсами!
default-information originate - сообщить соседям инфу о своем маршруте по умолчанию 

show ip protocols
maximum-path цифра - для ECMP баланстровки
distance 1-255 - сменить AD

                        EIGRP

Цисковский проприетарный, но она раскрыла его для общего пользования. Это продвинутый или гибридный дистанционно-вект орный пртокол 
Более быстрая сходимость, нету ограничения в 15 хопов, мкльтикаст 224.0.0.10

router eigrp 1 - цифра это номер автономной системы, у соседей должна быть одинакова
no auto-summary
passive-interface g0/2
network 10.0.0.0
network 172.16.1.0 0.0.0.15 - если все же нужно указать маску, то делается это так (здесь указана маска /28, это так называемая wildcard mask)

network 0.0.0.0 255.255.255.255 - включить на всех интерфейсах

show ip protocols
show eigrp neighbors - показать соседей подробно

show ip route connected/static/eigrp - показать конкретные маршруты

show ip eigrp topology

Метрика EIGRP это упрощенно = bandwidth + delay (точнее пропускная способноть самого медленного линка + суммарная задержка всех линков). Но сама формула сложнее

Router ID: (это не ip адрес, просто записывется как ip)
- вручную
- самый высший ip loopback
int loopback номер - создает лупбэк интерфейс с номером
- высший ip на физ интерфейсе
eigrp-router id цифра 

        Unequal cost load-balancinf in EIGRP

Сделать команду:
show ip eigrp topology
Если до одной сети есть 2 маршрута, то смотрим на цифры, чтобы понять возможно ли добавить второй маршрут до сети назначения (если он конечно есть) в таблицу маршрутов и таким образом сделать load-balancing

 Feasible distance (метрика от нашего роутера до сети назначения - 28672)
 Reported distance (метрика от соседа до сети назначения - 28416)

Вот чаcтичный вывод команды show ip eigrp topology
P 192.168.4.0/24, 2 successors, FD is 28672
         via 10.0.12.2 (28672/28416), GigabitEthernet0/0
         via 10.0.13.2 (30976/28416), FastEthernet1/0

 Successor - маршрут с наименьшей метрикой до сети назначения (best route)
 Feasible successor - альтернативный путь, но который соответствует feasibility condition:
        маршрут считается feasible successor если его reported distance меньше чем feasible diatance successor'а.
        то есть в данном случае 28416 второго маршрута меньше чем 28657 первого маршрута.

Если сделать вывод show ip protocols, то в стороке 
EIGRP maximum metric variance 1
Variance равное 1, говорит о том, что только маршруты с равнозначными метриками могут участвовать в ECMP load-balancing, поэтому надо изменить значение variance
variance 2

Таким образом мы говорим, что любой маршрут до сети удовлеворяющий feasibility condition и имеющий Feasible distance менее чем 28672*2, будет участвовать в load-balancing
Но кол-во трафика через эти пути будет разное, так как разная метрика.

                OSPF

Роутер рассылает кадры LSA, чтобы все соседи постоили LSDB (базу данных)
После постороения LSDB роутеры используют алгоритм Дейкстры для построения наилучшего маршрута

Этапы:
1) Установление соседских отношений
2) Обмен LSA
3) Расчет наилучшего маршрута

Area - группа роутеров и линков, которые используют и делят между собой одну LSDB
Backbone area (0) - особая зона, с которой должны быть соединены все остальные areas
Внутренние роутеры - у которых все интерфесы внутри area
ABRs (area border routers) - роутеры между разными areas
BR (backbone router) - роутер соединенный с area 0, любой у которого хоть 1 интерфейс соединен с area 0
Intra-area route - маршрут внутри area
Interarea route - между areas
ASBR (autonomous system boundary router) - OSPF роутер, соединенный с внешней сеткой (появляется после ввода раздачи команды по умолчанию)

router ospf номер (номер не обязательно должен совпадать на всех ройтерах, это врктренний номер), это не номер area
network 10.0.12.0 0.0.0.3 area 0 (для сети с маской /30)
network 172.16.1.0 0.0.0.15 area 0 (для сети с маской /28)
network 0.0.0.0 255.255.255.255 area 0 - включить на всех интерфейсах
passive-interface g 2/0
default-information originate - чтобы advertise default gateway

show ip protocols
router-id НОМЕР В ФОРМАТЕ IP адреса
clear ip ospf process - чтобы удалить старый Router ID без перезагрузки
maximum-path НОМЕР (по умолчанию 4)
distance НОМЕР - сменить AD дистанцию (по умолч 110)

        Cost 

Reference bandwidth/int bandwidth = 100/ напрмер 10Mb/s = 10
                                  = 100/ 100Mb/s = 1
Поэтому fastethernet, gigabit и так далее эквивалентны и = 1

        auto-cost reference-bandwidth мегабиты_в_секунду - чтобы сменить reference bandwidth
Значение нужно брать больше чем самый быстрый линк в твоей сети, на будущее (н-р 100000, таким образом у 1GBb линка стоимость будет 100000/1000=100, у FastEthernet = 1000)
loopback интерфейс имеет cost = 1

Настройка cost на интерфейсе:

int f0/0
ip ospf cost НОМЕР
или можно изменить bandwidth, но это не рекомендунтся
bandwidth ЦИФРА (в кб/сек)

show ip ospf int brife - посмотреть косты
show ip ospf neighbour

Установление соседства:
1) После вкл OSPF на интерфейсе  - down state 
2) Роутер отсылает Hello сообщение через равный hello timer (10s), это multicast 224.0.0.5. Сообщение инкапсулируется и ip заголовок содержит 89 в поле Тип Протокола. 
Hello сообщение содержит помимо прочего My RID: 1.1.1.1 и Neighbour RID: 0.0.0.0 (все нули так как мы пока не знаем о своем соседе)
Состояние OSPF в это время - init state
3) R2 добавляет инфу в свою таблицу соседей и отвечает так же Hello сообщением и R1 добавляет его в совю таблицу соседей
Потом R1 отсылает Hello сообщение уже с RID от R2 - это 2-way state
Тут идет DR/BDR election
4) Теперь роутеры готовы обменяться LSA пакетами и сформировать LSDB
Они выбирают кто будет master, а кто slave (exstart state)
Роутер с большим RID становится мастером и они обмениваются DBD (database description packets) в котором указано "Я буду мастер", но если RID R2 больше то он в ответ посылает свой DBD пакет "Нет, я"
5) Exchange state - обмениваются DBD содержащими базовую информацию об LSA (типо, я имею эти LSA, но основная инфа не передается)
Роутеры сравнивают данные об этих LSA, чтобы понять какие им надо
6) Loading state - роутер отсылает LSR (link state request) с инфой каких LSA у него нет (дай мне эти LSA), второй роутер отвечает ему пересылая эти LSA отправляя ему LSU (link state update) сообщение. После получения LSU роутер отвечает что получил эту инфу, отсылая сообщение LSAck. 
7)Теперь роутеры имеют одинаковую LSDB - full state
Они продолжают отсылать Hello пакеты каждые 10 сек для поддержания смежности
Как только роутер получает Hello сообщение он сбрасывает свой Dead timer (40s)

Можно включить OSPF сразу на интерфейсе:
int g0/0
ip ospf НОМЕР area НОМЕР

Пассивными можно сдлать все интерфейсы и потом исключить некоторые
passive-interface default
no passive interface g0/0


                OSPF Network type

1) BROADCAST
В каждой подсети из областидолжны быть выбраны DR and BDR routers, остальные становятся DROthers (они устанавливают смежность FULL только c DR and BDR, с другими роутерами у них состояние 2-way и просто соседство)
DR/BDR elections
- highest OSPF interface priority (по дефолту везде 1)
ip ospf priority ЦИФРА
clear ip ospf process - на роутере который является DR, и тогда прошлый BDR станет DRом, а мы станем BDRом
int g0/0
ip ospf priority НОМЕР
- Router ID
В такой сети роутеры обмениваются LSA сообщениями только с DR и BDR, но не с другими DROthers используя мультикаст адрес 224.0.0.6

2)Point-to-Point (используется в serial connection (ppp and HDLC encapsulation) )
Нет смысла выбирать DR and BDR, так как всего 2 роутера
По умолчанию инкапслуляция - HDLC, но можно настроить и PPP 
int g/0
encapsulation ppp
clock rate ЦИФРА - настройка скорости обящзательна на DCE стороне
Одна из сторон становится основной (DCE), а вторая берет настройки от первой (DTE)
show controllers s0/0 - посмотреть какая сторона DCE или DTE

3) Ручная настройка типа сети на интерфейсе
ip ospf network ? 

Чтобы OSPF нормально работал на интерфейсах есть несколько условий:
1) Area должна быть одинаковая
2) Интерфейсы должны быть в одной подсети
3) Router-id должны быть уникальны
router-id ЦИФРА
4) Должны совпадать там=ймеры Hello and Dead
настраиваются непосредственно на интерфейсе
5) Сам OSPF не должен быть shutdown
6) Настройки аутентификации должны совпадать
пароль так же настраивается на интерфейсе
ip ospf authentification-key ПАРОЛЬ - установить пароль
ip ospf authentification - включить аутентификацию
7) IP MTU должны совпадать (1500 байт по дефолту) - соседями станут, но в FULL не перейдут
так же на интерфейсе
ip mtu ЦИФРА
8) Должен совпадать OSPF network type

        Типы LSA

Всего 11, но для CCNA надо знать 3
1 тип) Router LSA - показывает router-id и какие сети есть за интерфейсом
2 тип) Network LSA - отсылаются только DRом и показывают список роутеров, которые в данной сети
5 тип) AS External LSA - генерируются толко ARSBом 

                FHRP (first hop redundancy protocol)

1) HSRP (hot standby router protocol)
2) VRRP (virtual router redundancy protocol)
3) GLBP (gateway load balancing protocol)


 Два роутера делят один га двоих virtul IP, и он настраивается в качестве defaul gateway на хостах. Они согласуют этот адрес путем рассылки multicast "Hello" друг другу
 Когда комп хочет вы1ти в другую сеть, то он запрашивает мак у своего default gateway и ему отвечает ACTIVE ROUTER, отсылая свой virtual mac-address
Если STANDBY ROUTER не получает Hello сообщений, он становится Active и отсылает gratuitous ARP reply броадкастом на ff-ff-ff-ff-ff-ff, чтобы изменить Arp-table на свичах
Если R1 заработает снова, то он станет STANDBY ROUTER, но можно настроить чтобы он обратно становился ACTIVE ROUTER

HSRP
- cisco proprietary protocol
- multicast "Hello" 224.0.0.102 (version 2, v2 использует 224.0.0.2)
- virtual mac-address (v1 - 0000.0c07.acXX, v2 - 0000.0с9f.fxxx, где XX - это номер HSRP группы)
Настраивается непосредственно на интерфейсе. 
inn g0/0
standby version 2 - переключить на 2 версию, необязательно
standby 1 ip АДРЕС - указать группу (в идеале чтоб совпадала с VLAN) и IP
standby 1 priority 200
standby 1 preempt - после восстановления после поломки стать ACTIVE, даже если другой уже является ACTIVE 
ACTIVE ROUTER определяется значением priority (default 100 )или ip адресом
show standby - показать общий вывод  настройки HSRP


VRRP
- open standart
- MASTER and BACKUP ROUTER
- multicast 224.0.0.18
- 0000.5e00.01XX

GLBP
- cisco proprietary
- load balancing для хостов из одной подсети
- выбирается AVG (active virtual gateway)
- он выбирает до 4ч AVFs (active irtual forwarder), каждый изкоторых отвечает за сою порцию хостов в сети
- 224.0.0.102
- 0007.b400.XXYY, гду XX - группа и YY - AVF


                TCP/UDP 

0 - 1023 - well-known
1024 - 49151 - registered
49152 - 65535 - private/dynamic

TCP - connection-oriented protocol (3-way handshake SYN, SYN+ACK, ACK), and 4-way FIN, ACK and FIN, ACK). Это флаги в TCP хэдере
TCP provide sequencing / acknowledgment - seq 10(рандомный номер) - seq50 + ack11 (номер ожидаемого сегмента) - seq11 + ack51 - и тд 
Таким образом сервер сообщает хосту (и наоборот) что получен каждый сегмент последовательности. Если подтверждение с ожидаемым номером сегмента не получено, то хост снова отправляет сегмент
TCP provides flow control - в заголовке есть поле - ОКНО, поэтому можно сразу по очереди прислать несколько сегментов и получить ack от сервера только на последний сегмент, так как ждать ack на каждый не эффективно

UDP - connection-less protocol
Номера портов: 
DHCP server - 67
DHCP client - 68
TFTP - 69
SNMP agent - 161
SNMP manager - 162
Syslog - 514


                IPv6

Binary - исрользуется префикс 0b, чтобы мы знали что это Binary (н-р 0b10 - это 00000010,т е двойка в двоичной системе)
Decimal - 0d
Hexidecimal - 0x, каждое число состоит из 4х бит

128 битное число, 32 16-ти битных числа, разделенных на 8 колонок по 4 числа в каждой колонке, каждое число это 4 бита
По умолчанию адрес IPv6 имеет маску /64, что значит что половина адреса - это адрес сети, а вторая половина - это адрес узла. 
Чтобы сократить запись адреса можно не писать нули, можно сократить все последовательно идущие нули и вместо них написть ::

ipv6 unicast-routing - вкл ipv6 из R1(config)#
ipv6 address 2001:db8:0:1::1/64
show ipv6 interface brief

        EUI-64

Extended unique Identifier - метод автоматического генерирования ip адреса используя спец префикс и мак адрес интерфейса
Чтобы конвертировать mac в ETI-64, нужно
1) Разделить его на 2 половины
2) Вставить в середину FFFE
3) Замеить 7ой бит на противоположный (это 3й бит второго числа, так как в каждом числе 4 бита)

int g0/0
ipv6 address 2001:db8:0:1::/64 eui-64
no shutdown

do show ipv6 int br - инфа 

Если не назначая ip адрес заранее просто включить ipv6 на интерфейсе командой ipv6 enable, то автоматически создастся ipv6 link-local адрес FE80::и так далее по EUI-64

        Global unicast address

Глобальный, маршрутизируемый в интернете
Должны быть в промежутке от 2000::/3 (от 2000:: до 3fff:ffff:ffff:ffff:ffff:ffff:ffff:ffff) 
2001:0DB8:8B00:0001:0000:0000:0000:0000/64 
______________ - первые 48 бит это global routing prefix, назначаемый ISP
               ____ - subnet Identifier
___________________ - это вместе ipv6 network prefix
                    ___________________ - interface identifier (хостовая часть, которая генерируется EUI-64 или ручками)

                Unique local address 

Приватный адрес, не может использоваться в интернете
FD45:93AC:8A8F:0001:0000:0000:0000:0000/64
__ - указывает что это unique local address
  ____________ - global ID (реклмендуется чтобы был сгенерирован рандомно, чтобы при слиянии комапний он не совпадал)
               ____ - subnet identifier

                Link-local address

Автоматически генерируется на ipv6 интерфейсе
ipv6 enable
FE80::/10 (FE80:: to FEBF:FFFF)
Начинаются только с FE8 остальныйе 54 бита это все нули.
Вторая часть (interface id) генерируется с использованием EUI-64
Этот тип адреса используется внутри подсети и нет маршрутизируется в другие подсети
- используются в OSPFv3 для установления смежности
- используется для статических маршрутотв как next hop
- используется протоколом NDP (замена arp)
с таких интерфейсов нельзя пинговать, так как они не маршрутизируемые

                Multicast address

FF00::/8 (с FF00:: до FFFF:FFFF_и_так_далее_:FFFF )
В ipv6 нет броадкаста
FF02::1 - мультикаст адрес на все хосты подсети
FF02::2 - на все роутеры
У мультикаста есть scopes:
- interface-local (FF01) - пакет используется для нужд внктри роутера
- link-local (FF02) - пакеты остаются внутри сети
- site-local (FF05) - могут маршрутизироваться роутерами, но не должны уходить в WAN, ширина распространения регулируется сетевым инженером
- organization-local (FF08) - ходят внутри организации, ширина распространения регулируется сетевым инженером
- global (FF0E) - без границ, могут уходить в интернет, ширина распространения регулируется сетевым инженером 

                Anycast address

Берется адрес Global unicast или Unique local и назначается anycast адресом 
int g0/0
ipv6 address 2001:db8:1:1::99/128 anycast 
do show ipv6 int br

:: - когда интерфейс не знает свой адрес
::/0 - edfault gateway

::1 - loopback 

                RFC (request for comments)

RFC 5952 - описывает как правильно записывать ipv6 адрес

Solicted-node milticast address
Надо взять FF02::1:FF и добавить сюда послежние 6 цифр unicast local адреса

                NDP (neighbour discovery protocol)

Замена ARP в IPv6
Используются 2 типа сообщений:
1) NS (neighbour solicitation) типо как arp request. ICMPv6 тип 136
2) NA (neighbour advertisement) ICMPv6 type 136

show ipv6 neighbour

Еще одна функция NDP это нахождение роутера в локальной сети
1) Router solicitation (RS) - ICMPv6 type 133 расылается на мультикаст адрес FF02::2 (all routers)
2) Router Advertisement (RA) - ICMPv6 type 134 рассылается на мультикаст адрес FF02::1 (all nodes)

                SLAAC (Stands for stateless address auto-configuration)

ipv6 address autoconfig - используется NDP, а именно RS and RA для того, чтобы узнать префикс и автоматически генерируется ipv6 адрес (используя EUI-64 чтобы сгенерить interface ID)

        DAD (duplicate address detection)

Каждый раз когда интерфейс вклбчается или назначается ipv6 адрес происходит проверка на дубликаты используя проокол NDP, а имеенно сообщени NS и NA
Роутер отсылает NS сообщение на свой собственный Solicited node multicast address и если он не получает ответ, то значит адрес - уникальный

                IPv6 Static Routing

show ipv6 route
ipv6 unicast-routing - вклбчить ipv6 роутинг

Создать маршрут ipv6  можно 3мя способами:
ipv6 address адрес/префикс {некст-хоп|интерфейс [некст-хоп]} [ad]

- directly attached (данная команда не работает в ipv6 !!!)
ipv6 адрес/префикс g0/0

- reursive attached (роутеру приходится чекать таблицу 2 раза)
ipv6 адрес/префикс некст-хоп (а чтобы интерфейс который сморит на сеть где живет некст-хоп, надо чекнуть таблицу еще раз)

- fully specified
ipv6 адрес/префикс g0/0 некст-хоп

ipv6 route ::0 некст-хоп - маршрут по умолчанию

Можно использовать link-local address как next hop, но тогда надо указывать fully specified route (то еть интерфейс и link-local адрес этого интерфейса)
ipv6 адрес/префикс g0/0 link-local address 

Если добавить маршрут до одной сети через разные интерфейсы (один как основной, второй как бэкап), указав AD у второго больше (н-р 2), то второй маршрут не будет отображаться в таблице маршрутизации. Чтобы увидеть его надо посмотреть
show run conf | include ipv6 

                ACL (Standart access control lists)

На один интерфейс можно повесить только по одной ACL для каждого направления. Если ACL уже были указаны, и вы создаете новую, то она заменить существующую
Implicit deny - если трафик не соответствует ни одному условию в ACL, то роутер его дропнет
       
        2 вида ACL:
- Standart ACL (numbered and named) - основаны только на SOURCE IP
номера 1-99 и 1300-1999
access-list НОМЕР {deny|permit} IP wildcard mask

access-list 1 deny 1.1.1.1 0.0.0.0 - заблокировать толькл данный хост
access-list 1 deny 1.1.1.1 - можно и так для конкретного адреса
access-list 1 deny host 1.1.1.1 - старый вариант, но тоже работает

access-list 1 deny 192.168.1.0 0.0.0.255 - заблокировать сеть /24

access-list 1 permit any - разрешить все остальное
access-list 1 permit 0.0.0.0 255.255.255.255 - или так

access-list 1 remark # ОПИСАНИЕ # - комментарий к аксесс листу, хэштег не обязателен (отображается только в конфиге, что неудобно)

show access-lists
show ip access-lists
show run | include access-list
show run | section access-list

int g0/0
ip access-group НОМЕР {in|out}

ip access-list standart ИМЯ - настройка именованой ACL (с помощью данной команды мы попадаем в конфиг мод стандартной ACL)
{deny|permit} ip wildcard-mask
int g0/0
ip access-group ИМЯ {in|out}

Преимущества named ACL:
1) При использовании именованных ACL, а не нумерованных, с помощбю команды no и далее номер строки можно удалить строку в ACL. Если так же удалять в нумерованной ACL, то по какам то причинам удалится вся ACL, а не конкретная строка
2) Можно добавлять строки в середину
3) Можно увеличивать шаг числа последовательности
ip access-list reseqence 1 10 10 - аксесс-лист 1 сделать последовательность с 10 и с шагом 10

- Extended ACL (numbered and named) - основаны на src/dst IP and ports
100-199 и 2000-2699

ip access-list extended ИМЯ_или_НОМЕР
номер_строки deny|permit protocol src dst

н-р:
deny tcp any 10.0.0.0 wildcard_mask
permit ip any any - разрешить всё
deny udp 10.0.0.0 0.0.255.255 host 192.168.1.1 - запретить udp с сети 10... до хоста 192...
deny icmp host 172.16.1.1 192.168.0.0 0.0.0.255 - запретить пинг с хоста 172... до сети 192... с 24 маской 

permit tcp host 192.168.1.1 172.16.1.1 0.0.0.0 eq 443
deny udp any range 20000 30000 host 3.3.3.3 - запретить доступ к хосту 3... всем кто стучится по UDP с данного диапазона портов
permit tcp host 172.16.1.1 gt 9000 host 192.16.1.1 neq 23 - позволять хосту подключаться по TCP с портом источника более 9000 к хосту 192... ко всем портам кроме 23

!ВАЖНО! Extended ACL должны применяться к интерефейсу который ближе всего к источнику, чтобы зря не гонять трафик


        LAYER 2 DISCOVERY protocols

CDP - проприетарный протокол Cisco
Включен по дефолту, сообщения получают только соседи и не пересылаются дальше на другие интерфейсы
CDP сообщения отсылаются на мультикаст адрес 0100.0ССС.СССС каждые 60 сек
HoldTime 180s, после чего сосед удаляетя из таблицы

show cdp/cdp traffic/cdp interface
show cdp neighbours 
show cdp neighbours detail
show cdp entry R2 - показать инфу по конкретному соседу

cdp [no] run - вкл или отключить cdp
(config-if)# cdp [no] enable - на интерфейсе
cdp timer TIME_IN_SEC
cdp holdtime TIME_IN_SEC
[no] cdp advertise-v2 - вкл или откл 2ю вкрсию (она вкл по дефолту)


LLDP - инд стандарт IEEE 802.1AB
Сообщения отсылаются на мультикаст адрес 0180.с200.000e
30s/120s
Чтобы сключить LLDP надо вкл его глобально и на интерфейсе
lldp run
(config-if)# lldp transmit - вкл отправку lldp
(config-if)# lldp receive - вкл получение lldp
lldp timer СЕКУНДЫ
lldp holdtime СЕКУНДЫ
lldp reinit СЕКУНДЫ - реинит таймер (по деф 2с) это время которое выжидает LLDP перед отправкой сообщений после включения интерфейса

show lldp
show lldp traffic
show lldp interface
show lldp neighbours
show lldp neighbours detail
show lldp entry SW1

                                NTP (network time protocol)

show clock
show clock detail - показать источник времени
clock set 14:30:00 27 Dec 2023 - нпстроить software clock (надо настраивать в формате UTC)
calendar set 14:30:00 27 Dec 2023 - настроить hardware clock
clock update-calendar - чтобы настроить hardware clock по системным часам
clock read-calendar - системные по хардварным

clock timezone JST 9 - установить часовой появляется
clock summer-time EDT reccuring 2 Sunday March 02:00 1 Sunday November 02:00

        NTP

Порт udp 123
Stratum 15 - это максимальный слой удаленнойсти от reference clock и все что авше считпется ненадежным

Циско девайсы могут работать в 3х режимах:
- server
- clientS
- symmetric active mode

Сервера Stratum 1 называются primary servers
Остальные сервера - secondary

ntp server IP_АДРЕС - лучше указать несколько (после чего software clock (UTC) синхронизируются с данным сервером)
ntp server IP_АДРЕС prefer - сделать предпочтительным один из нескольких, если указал несколько
show ntp associations 
show ntp status 

Чтобы сделать роутер NTP скрвером нужно создать loopback интерфейс и назначить его ичтоиком
ntp source loopback 0

ntp master [номер стратума]- сделать роутер сервером NTP, даже если он не связан c другим сервером NTP от которого он получает время

ntp peer IP_АДРЕС
ntp peer IP_АДРЕС

ntp authenticate - включить аутентификацию
ntp authentication-key НОМЕР_КЛЮЧА md5 КЛЮЧ 
ntp trusted-key НОМЕР_КЛЮЧА
ntp server IP_АДРЕС key НОМЕР_КЛЮЧА - на самом сераере эту команду вводить не надо, только на клиенте

                        DNS (domain name system)

Это служба используемая для резолвинга человекочитаемых имен в ip адреса.
ipconfig /all - для windows чтобы увидеть все об интерефейсе
nslookup YOUTUBE.COM - чтобы узнать ip адрес по имени
dns query ---> dns response
В основном это UDP 53 port

ipconfig /displaydns - показать днс кеш виндовс
ipconfig /flushdns - очистить локальный DNS кеш компа виндовс
windows/system32/drivers/etc/hosts - локальный файл для днс записей (использовался раньше до создания DNS)

        Настройка DNS сервера на роутере

ip dns server - включить днс сервер на роутере
ip host R1 192.168.1.1
ip host PC1 192.168.1.10 и т.д. - назначаем статические имена днс
ip name-server 8.8.8.8 - настрить внешний DNS сервер для свмого роутера на котором стоит внутренний DNS сервер
ip domain lookup - обязветльно надо включть, чтобы сам роутер мог cовершать запросы на внешний DNS сервер
(иногда эта команда вкл по дефолту)

show hosts - посмотреть записи DNS кеша на роутере

        Настройка роутера как DNS клиента

ip name-server 8.8.8.8
ip domain lookup


ip domain name ИМЯ - назначить доменное имя


                                DHCP (dynamic host configuration protocol)

ipconfig /release - освободить ip адрес на винде
ipconfig /renew - получить новый ip

DHCP серверы используют UDP 67
DHCP клиенты - UDP 68

        DORA
1) DHCP discover - это броадкаст сообщение "Есть ли в сети DHCP сервер? Мне надо ip адрес"
2) DHCP offer  - ответ от сервера "Как насчет этого ip адреса?"
3) DHCP request - ответ от клиента "Да я беру этот адрес" (в данном сообщение клмент указывает какому серверу (если их в сети несколько) он отвечает, но указывает он это в самом теле сообщения, а не в ip адресе назначения)
4) DHCP Ack - сервер подтверждает, что клиент может использовать запрошенный ip адрес

        DHCP Relay 
Просто пересылает DHCP запросы и ответы от клиента к серверу, находящемуся в другой LAN и обратно

        DHCP server configuration
ip dhcp excluded-address 192.168.1.1 192.168.1.10 - указать какой диапазон ip не будут назначаться (это не обязательная команда)
ip dhcp pool LAB_POOL
network 192.168.0.0 255.255.255.0
dns-server 8.8.8.8 - какой днс будет использовать клиент
domain-name company.local - указать доменное имя сети (в итоге будет например pc1.company.local)
default-router 192.168.1.1
lease 0 5 30 - дня часы минуты

show ip dhcp binding - показывает всех dhcp клиентов

        DHCP Relay
int g0/1
ip helper-address 192.168.10.10 - адрес DHCP сервера

        DHCP client
int g0/1
ip address dhcp


show ip dhcp pool - посмотреть инфу по всем пулам


                        SNMP (simple network management protocol)

Протокол или даже фреймворк предназначенный для менеджмента (сбора инфы о дивайсе, управления и настройки) сетевого оборудования

- managed devices - те роутеры и свичи которвми мы аправляем
- network managment station - это SNMP сервер

- девайсы могут информировать серверт о каких либо измемнениях (напрмер если упал интерфейс)
- сервер может спрашивать девайсы о текущем статусе
- сервер может сказать девайсам поменять конфигурацию

Те или иные значения сохранены на девайсе в переменных, и сервер запрашивает или говорит изменить те или иные переменные (напрмер имя, ip адрес интерфейса и тд)

Виды SNMP сообщений:
- READ (get, genNext, getBulk)
- WRITE (set)
- NOTIFICATION (trap, inform) trap не получают response в ответ и считаются ненадежными
- RESPONSE (response)

SNMP Agent слушает UDP 161
SNMP Manager - UDP 162

        Настройка агента на роутере (R1):
snmp-server contact jeremy@jeremysitlab.com
snmp-server location Jeremy's home - эти две строчки просто общая инфа
snmp-server community ПАРОЛЬ1 ro - используя этот пароль SNMP сервер сможет только читать инфу с R1 (не сможет использовать SET сообщения)
snmp-server community ПАРОЛЬ2 rw - сможет уже настраивать девайс и читать
snmp-server host 192.168.1.1 version 2c ПАРОЛЬ1 - указваем сервер, версию протокола и коммьюнити стринг (пароль)
snmp-server enable traps snmp linkdown linkup - настраиваем traps (интерфейс упал или поднялся)
snmp-server enable traps config - если конфиг изменится, то traps будет отправлен на сервер

SNMPv1 и v2 не шифруются и пароль передается в открытьм виде, поэтому нужно использовать 
v3

show snmp ?

                        Syslog

Syslog это индустриальный стандарт протокола для сообщений логгирования
seq:time stamp: %facility-severity-MNEMONIC:description - 
порядковый номер события : время события : какой процесс на дивайсе сгенерировал сообщение - важность/критичность события - короткий код события, говорящий что произошло : детальное описание произошедшего события 

        Syslog severity levels (8 шт)
0 - Emergency
    Alert 
    Criticaд
    Error
    Warning
    Notice 
    Informational
8 - Debugging

Every Awesom Cisco Engeneer Will Need Ice cream Daily

Отображение сообщений
1) В CLI с 0 по 7 по дефолту - при подключении через консольный порт
2) VTY линии - так же отображаются в CLI, но при подключении через SSH или TELNET (не отображается по дефолту)
3) Buffer - значит что syslog сообщения будут сохранены в RAM
   show logging - помотреть доги из буфера (RAM)
4) Внешний сервер - можнонастроить отправку логов на внешний сервер
   Syslog server слушает UDP 514 порт

Настройка логированя на девайсе:
 - в консоле
logging console 6 - отображать все логи в консоле с 6 и выше по приоритету. По дефолту плказ логов в консоле и так включен, причем всех severity levels (c 7 и выше)
 - в VTY
logging monitor informational - можно указать номер вместо 
По дефолту отображение логов выключено, включается клмандой
terminal monitor (надо вводить каждый раз при подключении по Telnet or SSH)
logging synchronous - нужно вводить в контексте определенной линии, чтобы логи появляющиеся в процессе ввода команд не разрывали команды надвое и все удобно читалось 
line console 0
logging synchronous
 - в буфере
logging buffered 8192 6 - размер в байтах (не обязательно указывать) и уровень
 - на внешний сервер 
logging 192.168.1.1
или
logging host 192.168.1.1
logging trap debugging - эта команда для настройки уровня сообщений посылаеых на сервер

service timestamps log datetime|uptime - включить временные метки
service sequence-numbers - включить нумерацию логов

show logging - посмортеть настройки логгирования

                                SSH (secure shell)

        Настройка Console port
По дефолту подключится к CLI через console port можно без пароля, однако пароль можно установить через контекст console line
line console 0 - так как  есть только одна линия подключения через консольный порт (т е одновременно может быть подключен только одинт юзер), то номер всегда - 0
password ccna 
login - включить подключение по паролю (без этой команды подключение будет по прежнему без пароля)
end

Можно настроить чтобы при подключении по консольномк порту запрашивался общий логин и пароль, созданный ранее
username ИМЯ secret ПАРОЛЬ
line console 0
login local
exec-timeout 3 30 - макс время неактивности
end

После этих команд login mode смениться с login на login local и пароль введенный на предыдущем шаге (настройки только для конс порта) больше не активен

Чтобы подключится удаленно (telnet or ssh) к свичу L2 нужно назначить ip адрес на вирт интерфейс SVI
interface vlan1
ip address 192.168.1.253 255.255.255.0
no shutdown
exit
ip default-gateway 192.168.1.254

        Настройка telnet (23 port)
enable secret ПАРОЛЬ - обязательно настроить пароль, иначе не войдешь в #
username ИМЯ secret ПАРОЛЬ
access-list 1 permit host 192.168.2.1
line vty 0 15 - подключения по ssh and telnet настраиваются на VTY lines (virtual teletype), всего их 16, что значит одновременно могут быт подключены 16 юзеров
login local
exec-timeout 5 0
transport input telnet/ssh/all/none - какой тип соединения разрешен на линиях VTY
access-class 1 in - применяем ACL на эти линии VTY (ВНИМАНИЕ! НЕ access-group !)

        Настройка SSH (22 port)

show version 
И если покажет K9, значит девайс поддерживает SSH (н-р: vios_l2-ADVENTERPRISEK9-M)
show ip ssh - поддерживается ли SSH,  версия 1.99 означает поддержку SSHv1 и SSHv2, но до создания RSA ключа SSH - disabled
Для начала нужно сгенерировать RSA ключ, но до этого установить FQDM на девайс, но до этого сменить дефолное hostname
hostname ИМЯ
ip domain name company.local
crypto key generate rsa
2048 - можно указать размер ключа, по дефолту 512
show ip ssh - теперь ssh - enabled

enable secret ПАРОЛЬ - обязательно настроить пароль, иначе не войдешь в #
username ИМЯ secret ПАРОЛЬ
access-list 1 permit host 192.168.2.1
ip ssh version 2 - ограничить возможность только использование 2ой Версии
line vty 0 15
login local
exec-timeout 5 0
transport input ssh
access-class 1 in (ВНИМАНИЕ! НЕ access-group !)

                                FTP and TFTP

        TFTP (Trivial FTP)
TFTP появился после FTP, он проще и позволяет только копировать файлы с сервера и на сервер
У него нет аутентификации, любой может скопировать файлы
Нет шифрования файлов, все передается в открытом виде
Сервер слушает UDP 69
Хотя TFTP использует UDP он сам предоставляет функцию надежной доставки сообщений. И сервер и клиент (в зависимости кто отправляет, а кто получает файл) отсылают Ack сообщение на каждый пакет полученных данных

Передача файлов по TFTP состоит из 3х фаз:
1) Connection
2) Data transfer
3) Connection termination
При первом подключении клиент использует 69 порт, но сервер отвечает с рандомного порта (TID - transfer identifier) и уже он используется далее

        FTP
Использует TCP 20 (ftp data connection - для передачи файлов) и 21 (ftp controll connection - используется для соединения и отсылки комманд)
Есть аутентификация, но тоже нет шифрования
Для безопасности можно использовать FTPS (FTP over SSL/TLS) - это апгрейд FTP
или SFTP (SSH FTP) - это новый протокол просто с похожим именем
FTP в отличие от TFTP может не только копировать файлы, но и перемещаться по директориям, удалять и тд

Сначала клиент инициализирует CONTROL CONNECTION и после установки соединения и отправки всех команд нужно допустим скачать файл. Существует 2 способа установки FTP data connection:
1) Active mode - клгда сервер инициирует TCP соединение, после чего FTP data connection считется установленным
2) Passive mode - когда клиент инициирует TCP сессию, это важно когда клиент находится за файерволом, блокирующим внешние подключения

        IOS file system
show file systems
- disk - это флэш память (тут обычно хранятся файлы самой Cisco IOS). Когда девайс стартует, то файлы отсюда копируются в RAM
- opaque - используется для спец внутренних функций
- nvram - это внутренняя NVRAM. Файлы startup config хранятся тут
- network - олиценторяет внешнии файловые системы (FTP серверы например)

show version - посмотреть текущую версию IOS
show flash - посмотерть содержимое flash памяти

                Копирование файла прошивки с TFTP сервера

copy tfth: flash: - копи ИСТОЧНИК и НАЗНАЧЕНИЕ
Далее вас попросят указать ip адрес tftp сервера и затем имя файла (напоминаю что при использовании TFTP нельзя посмотерть содеожимое сервера, поэтому нужно знать имя)
Затем - под каким именем его сохранить на роутере
show flash - проверяем что файл скачался

Теперь чобы заставить роутер загрузится с этой прошивки нужно из глобал конфиг мод выполнить команду
boot system flash:ИМЯ_ФАЙЛА
write memory - сохраняем конфигурацию
reload

После перезагрузк проверяем та ли версия загрузилась:
show version
delete flash:ИМЯ_СТАРОЙ_ВЕРСИИ - удаляем старую версию

                Копирование файла прошивки с FTP сервера

ip ftp username ИМЯ_ЮЗЕРА
ip ftp password ПАРОЛЬ - конфигурируем имя и пароль для доступа к ftp серверу
copy ftp: flash: - далее все как выше

                                NAT (network address translation)

        Static NAT
Когда каждому компу из сети выдается свой публичный ip адрес. То есть роутер транслирует приватный ip адрес компа в какой то строго определенный публичный. И так для каждого компа.
Здесь есть 2 понятия:
- inside local ip - это приватный ip компа
- inside global ip - это публичный ip компа, в который роутером транслировалсЯ его приватный адрес (это не адрес сконфигурированный на самом компе, это адрес выдает именно роутер, но конкретно для данного компа)
Так как static NAT требует one-to-one mapping, он не способствует сохранению ip адресов

        Настройка static NAT:
int g0/1 - сначала определяем внутренний интерфейс за которым сидят хосты
ip nat inside
int g0/0 - определяем интерфейс, который смотрит наружу и за которым мы хотим применять NAT
ip nat outside

ip nat inside source static 192.168.0.167 100.0.0.1
ip nat inside source static 192.168.0.168 100.0.0.2

show ip nat translations

clear ip nat translation * - очичтить таблицу вручную, статические записи остануться

show ip nat statistics 

        Dynamic NAT
Тут используются ACL (access lists) чтобы идентифицировать трафик который должен быть транслирован посредством NAT
Далее используется NAT POOL для поределения доступных inside global адресов     

        Настройка dyanmic NAT
Так же как и в static NAT нужно определить какой интерфейс соединен с внуренней сетью, а какой с внешней
int g0/1 - сначала определяем внутренний интерфейс за которым сидят хосты
ip nat inside
int g0/0 - определяем интерфейс, который смотрит наружу и за которым мы хотим применять NAT
exit

access-list 1 permit 192.168.0.0 0.0.0.255 - какой трафик будет транслирован
ip nat pool POOL1 100.0.0.0 100.0.0.255 prefix-lenght 24 - вводим доступный нам пул inside global ip адресов
ip nat inside source list 1 pool POOL1 

        PAT (port address translation)  (NAT overload)
Когда роутер транслирует ip адрес и порт хоста в свой публичный ip адрес и такой же, или другой порт.

        Настройка PAT
Так же как и в static NAT нужно определить какой интерфейс соединен с внуренней сетью, а какой с внешней
int g0/1 - сначала определяем внутренний интерфейс за которым сидят хосты
ip nat inside
int g0/0 - определяем интерфейс, который смотрит наружу и за которым мы хотим применять NAT
exit

access-list 1 permit 192.168.0.0 0.0.0.255 - какой трафик будет транслирован
ip nat pool POOL1 100.0.0.0 100.0.0.3 netmask 255.255.255.0 - вводим доступный нам пул inside global ip адресов
ip nat inside source list 1 pool POOL1 overload

        Если роутер имеет один публичный ip адрес, то настройка такая

Так же как и в static NAT нужно определить какой интерфейс соединен с внуренней сетью, а какой с внешней
int g0/1 - сначала определяем внутренний интерфейс за которым сидят хосты
ip nat inside
int g0/0 - определяем интерфейс, который смотрит наружу и за которым мы хотим применять NAT
exit
access-list 1 permit 192.168.0.0 0.0.0.255 - какой трафик будет транслирован
Пул тут создавать не надо
ip nat inside source list 1 interface g0/0 overload - привязываем на интерфейс

                        VOIP, POE, QOS

        VoIP (voice over IP)
int f0/0
switchport mode access
switchport access vlan 10
switchport access voice vlan 11

        PoE (power over ethernet)
power inline police
power inline police action log
Эти команды предотвращают получению слишком большого кол-ва DC потребителем

        QoS (quality of service)
Три важных момента:
1) Bandwidth - полоса пропускания (н-р 100Mb/s)
2) Delay - задержка (one-way delay и two-way delay)
3) Jitter - разновидность one-way delay - разница между пакетами отправленными одним приложением (напрмер в основном пакеты доходят до адресата за 10 мс, а какой то идет 100 мс - это большая разница )
4) Loss - процунт пакет ов не дошедших до адресата
Для норм функционирования нужно:
- one-way delay 150мс или меньше
- jitter 30мс и менее
- loss 1% и менее

По дефолту когда роутер (свич) получает пакеты со всех интерфейсов, кторые надо переслать далее, он лобавляет пакеты в очередь и уходят они по принципу FIFO
Хосты использующие TCP оспользуют sliding window чтобы повысить или уменьшить частоту отправки кадров. Хосты постоянно увеличивают частоту отправки кадров и как только происходит дропание какого либо пакета, то они уменьшают частоту, но потом увеличивают ее вновь и процесс дропания пакетов повторяется. Возникают волнообразные ухудшения связи.
Благодаря WRED (weighted random early detection) можно настроить какой трафик дропается, а какой нет в случае подной загрузки сети

Classification:
- ACL
- NBAR (network based application recognition) - это deep-packet inspection вплоть до layer 7

PCP (Priority code point) - поле 802.1q тэга в ethrtnet заголовке позволяет определить приоритет ьрафика
Поле PCP так же известное как Cos (Class of service) имеет размер 8 бит и соответственнро трафику может быть назначен один из 8 приоритетов (0 - дефолт и по возрастающей)

Поле заголовка ip пакета называемле ToS (type of service) разделено на 2 сегмента DSCP (6бит) и ECN (2бит)
DSCP (differentiated services code point) - поле в заголовке ip пакета служит для определения приоритета трафика
voice - RF
interactive video - AF4x
streaming video - AF3x
high priority data - AF2x
best effort (без приоритета) - DF 

ECN (explicit congestion notification) - уведомляет отправителя о перегрузках, чтобы он мог принять меры

        Queuing/Scheduling
CBWFQ - Class-based weighted fair queuing - популярный метод schtdulingа
Это не идеальный вариант для телефонии и видео

LLQ - low latency queuing
Как тока трафик приходит на эту очередь scheduler сразу начинает отправлять ее
Но в этом случае может быть такое, что все очереди стоят и отправляется только трафик данной очереди

        Shaping/Policing
POlicing - дропает трафик превысившиц полосу пропускания
Shaping - не дропает, а помещает в буфер и отправляет позже, когда загрузка инт-са упадет

        Настройка QoS (не требуется для CCNA)
Нужно сделать 3 вещи:
1) Идентифицировать траффик
class-map HTTPS_MAP - создаем такое класс для трафика
match protocol https - назначаем на этот класс весть трафик идущий по https

2) Как мы будем относится к каждому из созданных видов трафика
policy-map G0/0/0_OUT - создаем пустую политику
class HTTP_MAP - добавляем созданный ранее класс трафика
set ip dscp AF31 - назначаем приоритет трафику
priority percent 10 - назначаем приоритетную очередь в процентах при полной загрузке интерфейса
а если так, то это не приоритетная очередь:
bandwidth percent 5

3) Привязываем к интерфейсу
int g0/0/0
service-policy output G0/0/0_OUT

                                Security

CIA triad
- confidentally
- integrity
- availability

Dos (DDos) - это TCP SYN flood - т.е. атакующий шлет TCP SYN запросы на установление 3х стороннего рукопожатия при установлдении TCP сессии и сервер отвечает пакетом SYN-ACK и вынужден ждать ответа от атакующего, который он не получит. Таким образом сервер достигает максимального количества TCP соединений и не может реагировать на легитимные запросы в подклбючении к сераеру.
Ответы от сервера не достигают атакующего, потому что он подделывает свой ip адрес.

Spoofing - подделка адреса источника (mac or IP), например DHCP exhausting (атакующий шлет много DHCP discover massages c различных фейковых mac адресов)

Reflection - атакующий шлет трафик на рефлектора (DNS сервер), но использует не свой ip адрес, а адрес жертвы, и DNS отвечает жертве, заваливая ее трафиком
Amplification - смысл как и у reflection attack, но атакующий шлет мало трафика на DNS, но с таким запросом, что DNS отвкечает большим количесвом трафика

Man-in-the-middle - например arp spoofing (arp poisoning) - жертва отсылает arp запрос - У кого такой IP адрес? Сервер отвечает жертве и сразу после этого атакующий отвечает жертве и запись в ARP таблице жерты перезаписывается.
Теперь когда жертва отсылает трафик на сервер, то его получает атакующий, читает (модифицирует) и пересылает на сервер.

Reconnaisance attack - разведка и сбор сведений об объекте атаки 

Malware - virus, worms, trojan horses

Social engeneering - fishing (рассылка например писем от типо доверенной тебе организации) (spear fishing - на сотрудников определенной комапании, whaling - на президента компании, vishing - телефонный фишинг, smishong - смс фишинг)

Watering hole - размещение вредоносной ссылки на доверенном сайте

Tailgating - например проникновение в серверную.

Password-related attack - угадывание, подбор паролей по словарю или перебором


Multi-factor authentication - аутентификация, требующая помимо пароля еще какое либо подтверждение  (сканирования отпечатков пальца, подтверждение по коду пришедшему по смс и тд)

Digital sertifications - если организации нкжен сертификат, то на отправляет CSR (certificat signing request) в CA (certificate authority), которая генерирует и подписывает сертификат.
Теперь заходя на сайт организации мы можем проверить является ли сертификат доверенным, кто его подписал и тд

        Triple A 
- authentication - процесс установления (идентификации) юзера (напрмер при логине на сайт)
- authorization - процесс предоставления юзеру соответствующих доступов и привилегий
- accounting - процесс записи активности юзера в системе
Организации обычно используют AAA серверы для организации этих моментов
- RADIUS (udp 1812 и 1813)
- TACACS+ (это цисковский протокол, udp 49)

        Security programm elements
- user awareness
- user trainings
- physical access control

                                        Port Security
                                
Настраивается на интерфейсе и разрешает только определенные MAC адреса на порту свича (один - по дефолту, или более при настройке)
        Если чужой мак адрес подключится к интерфейсу, то могут быть разные варианты violation:
Дефолтное поведение интерфейса это - shutdown - интерефейс автоматически переводится в состояние err-disabled и отключается до того, пока админ не включит его вручную
Можно устанавливать лимит мак адресов, подключенных к порту

int g0/1
switchport mode access/trunk - порт секьюрити может быть применен только к аксесс портам или транка, не к тем кто dynamic auto или dynamic desirable
switchport port-security
show port-security interface g0/1

show errdisable recovery - посмотреть все причины выключения интерфейсов (не обязательно связанные с порт-секьюрити). В таблице будут показаны причины и статус вкл/выкл ли включение интерфейса через некоторое время при возникновении данной причины
errdisable recovery cause psecure-violation - включить автомвтическое включение интерыейса при возникновении errdisable в случае срабатывания port-security
errdisable recovery interval 180 - вновь включаться интерфейс будет через 180сек

- shutdown
switchport port-security

- restrict - свич дропает трафик от неавторизированного хоста, но сам интерфейс не отключается
switchport port-security
switchport port-security mac-address МАК_АДРЕС
switchport port-security violation restrict

- protect - свич так же дропает трафик, но интерфейс работает , однако так же не отсылает syslog и snmp сообщения и не увеличивает violation counter
switchport port-security
switchport port-security mac-address МАК_АДРЕС
switchport port-security violation protect


switchport port-security aging time МИНУТЫ - установить время хранения mac адресов на порту (действует только для динамисчески сохраненных свичем маков)
switchport port-security aging type absolute/inactivity - абсолют значит, что по исетчении таймера мак адрес удалится в любом случае, инактивити - значит что если по истечении таймера хост продолжает отсылать кажры, то время хранения обновится
switchport port-security aging static - установить время хранения mac адреса и для статически установленных руками маков, а не только для динамически записанных свичем

        Sticky secure mac addresses

switchport port-security mac-address sticky МАК_АДРЕС - эта команда будет добавлена в run conf и данный адрес никогда не истечет вне зависимости от общих настроек aging'а 
write memory - не забыть сохранить конфиг 

switchport port-security mac-address sticky - просто введя команду, она сохранит все динамически введенные маки в stiky, а если no.... , то наоборот 

show mac address-table secure - посмотериь все секьюрные маки

                                        DHCP Snooping

Это фича которая позволяет фильтроф=вать DHCP сообщения полуенные с недоверенных портов

Сообщения DHCP севера:
- offer
- ack 
- nak - противоположность ack, чтобы отклонить запрос клиента

Сообщения DHCP клмента:
- discover
- request
- release
- decline - чтобы отклонить ip адрес предложенный сервером

Существует 2 вида портов, доверенные и недоверенные.
Если любое DHCP сообщение получено с доверенного порта, то оно не проверяется и пропускается. Если с недоверенного, то:
- если это сообщение от DHCP сервера, то оно отклоняется
- если от клиента, то проверяется:
        - если это DISCOVER or REQUEST, то проверяется соответствие поля мак-адрес источника и поля CHADDR в самом DHCP сообщении. И там и там маки должны совпадать. Это сделано чтобы не допустить пересылку злоумышленником запроса от клиента
        - усли это RELEASE or DECLINE, то проверяется чтобы IP адрес источника этого сообщения и интерфейс соответствовали записи в таблице Snooping bindind table (show ip dhcp snooping binding).

        Настройка DHCP Snooping
ip dhcp snooping - просто вкл дхцп снупинг на свиче
ip dhcp snooping vlan 1 - далее надо вклбчить его на каждом vlane
no ip dhcp snooping information option - так как свич пересылающий dhcp сообщение от хоста пересылает его прикрепляет к нему "опцию 82" (это опция DHCP relay), то такое сообщение будет отброшено, так как по дефолту сообщения с этой опцией, при включенном DHCP спуфинге отбрасываются, поэтомы мы отключаем на свиче прикрепление этой опции к сообщению
int g0/0
ip dhcp snooping trust - делаем инт g0/0 доверенным (по дефолту все порты НЕдоверенные) так как он смотрит в сторону DHCP сервера
show ip dhcp snooping binding - смотрим таблицу 

        DHCP snooping rate limit
Устаноывка лимита соббщение DHCP на интерфейсе
int range f0/1 - 2
ip dhcp snooping limit rate 1 - устанавливаем лимит сообщений в 1 шт в 1 сек, если больше то интерфейс переходит в состояние errdisabled и отключается например (в наст сети надо делать цифру больше)
errdisable recovery cause dhcp-rate-limit - вкл errdisable recovery для dhcp-rate-limit
show errdisable recovery - посмотреть когда включено errdisable recovery

                        Dynamic ARP inspection
Gratuitous ARP - некоорые хосты отсылают ARP request, но им не требуется ответа, так как в ip адресе назначения указан его же адрес, а просто чтобы другие хосты узнали его мак и ip
Так же как и при DHCP снупинге все порты по умолчанию считаются недоверенными, и надо настроить доверенные порты смотрящие вверх (аплинки)
DAI проверяет мак адрес отправителя ARP запроса на untrusted порте и его ip адрес согдасно таблице DHCP snooping binding table и если все соответствует, то запрос проходит через интерфейс. То есть DAI полагается на DHCP snooping, но есть и другой метод: 
- использование в ручную настроенных ARP ACLs в которых определенному маку соответствует определенный IP (это особенно нужно, если хост имеет статический ip и значит его IP нет в таблице DHCP snooping binding table)

ip arp inspection vlan 1 - в отлчие от DHCP snooping нужна только одна команда для включения фичи
int range g0/0 - 1
ip arp inspection trust
show ip arp inspection interfaces - инфа о довер/недовер портах и лимите в сек (15 по умолчанию)

        DAI rate limiting
int range g0/1 - 2 - выбрать недоверенные интерфейсы
ip arp inspection limit rate 25 burst interval 2 - 25 пакетов за 2 секунды (по дефолту 15 пакетов за 1 сек) Сам burst interval можно не указывать, по умолчанию он равен 1 сек
При срабатывании условия интерфейс входит в состояние errdisable и выклбючается
Включить его можно:
- shutdown and no shutdown
- errdisable recovery cause arp-inspection
show errdisable recovery

ip arp inspection validate ? - ввести доп прверки на валидность ip адресов и соответсвие мак адресов в ethernet заголовке и внутри arp запроса/ответа
dst-mac
ip
src-mac
Если надо ввести все 3 проверки то надо писать их в одну строку, иначе последующаяя команда затрет предыдущую

        ARP ACLs
arp access-list ARP-ACL-1
permit ip host 192.168.1.10 (статический ip) mac host МАК_АДРЕС
ip arp inspection filter ARP-ACL-1 vlan 1 - привязываем это ACL к влану

show ip arp inspection 


