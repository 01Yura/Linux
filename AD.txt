Cброс пароля https://lifehacker.ru/sbros-parolya-windows-10/
при помощи проги https://www.youtube.com/watch?v=InHQYaLRHvc
Если локальный аккаунт заблочен https://www.youtube.com/watch?v=YR4nPiFRl18
                
                ОДНОРАНГОВАЯ СЕТЬ


    lusrmgr.msc - сменить имя локального пользователя на текущей машине
    sysdm.cpl - сменить размер файла подкачки 
    gpedit.msc - локальные политики (в system32)
    Мой компьютер - ПКМ Управление - пользователи (тут можно создать или удалить пользователя)
    ncpa.cpl - открыть сетевое окружение
    ipconfig - посмотреть свой ip
    ipconfig /release - освободить свой ip
    ipconfig /renew - запросить ipconfig
    ipconfig /flushdns - сбрость кэш DNS

    Полезное:

При переименовывании уже созданного пользователя папка, находящеяся в c/users остается не переименнованной. Надо имть это ввиду.
Если пользователя удалить, то останется его папка, и чтобы почистить всю инфу о нем, надо нажвть Мой комп ПКМ - advance system settings - user profiles

Включить встроенную учетку (Панель управления \ Администрирование \ Управление компьютером \ Локальные пользователи \ Пользователи \ ПКМ \ свойства \ отключенная учетная запись \ Задать пароль)
- включить учетку админа со стрелочкой вниз и задать ей пароль


Переименовываем учетку админа (Пуск \ Панель управления \ Administrative tools \ Локальная политика безопасности \ Локальные политики \ Параметры безопасности \ Учетные записи: Переименование учетной записи администратора \ adminic);
- для повышения секьюрности

Запретить отображение учетных записей (Пуск \ Панель управления \ Администрирование \ Локальная политика безопасности \ Локальные политики \ Параметры безопасности \ Интерактивный вход в систему: Не отображать последнее имя пользователя \ включен);
                              Не отображать имя пользователя при входе

gpedit.msc \ Конфигурация компьютера \ Административные шаблоны \ Компоненты Windows \ Пользовательский интерфейс учетных данных \ Отображать учетные записи администратора при повышении уровня прав \ Отключено                              

Требовать нажатия Ctrl+Alt+Del (Пуск \ Панель управления \ Администрирование \ Локальная политика безопасности \ Локальные политики \ Параметры безопасности \ Интерактивный вход в систему: Не требовать нажатия ctrl+alt+del \ отключен, т.е. требовать нажатия ctrl+alt+del);

Запретить вход в систему (Пуск \ Панель управления \ Администрирование \ Локальная политика безопасности \ Локальные политики \ Назначение прав пользователя \ Запретить локальный вход \ Добавить пользователя или группу \ Дополнительно \ Поиск \ office \ ОК \ ОК)

Лишить админских прав рабочие учетные записи (ПКМ \ Мой компьютер \ Управление компьютером \ Локальные пользователи и группы \ Администраторы)



    Более продвинутая система расшарвания ресурсов, это создания на какой либо машмне папки Файловый сервер и настройки ее и подпапок в ней. Но единовременно не может подключится более 20 пользователей (сессий)

Файловый сервер \ ПКМ \ Свойства \ Доступ \ Общий доступ \ Все \ Чтение и запись \ Поделиться 

Файловый сервер \ ПКМ \ Безопасность \ Все \ Дополнительно \ Все \ Изменить \ Применяется к: Только для этой папки

В итоге, теперь мы Разрешили полный доступ через настройку доступа, но запретили через настройку NTFS и теперь через NTFS будем настраивать уникальные права для папок.

Обмен (Безопасность \ Изменить \ Добавить \ Все \ Полный доступ)

Отдел продаж (Безопасность \ Изменить \ Economist \ Удалить \ Добавить \ Manager \ Полный доступ \ ОК)

Бухгалтерия (Безопасность \ Изменить \ Добавить \ Buhgalter \ Полный доступ \ ОК)

Документы (Безопасность \ Изменить \ Добавить \ все \ Только чтение и можно добавить сотрудника, который сможет добавлять сюда файлы)

                            Установка WIN11

Если устанавливаешь WIN11 на виртуалку, то там мин требования 2х ядерный проц (надо ставить), чип TPM 2.0, 4гб RAM, UEFI + secure boot. Но все кроме проца можно обойти, для этого в меню выбора версии ОС нажать SHIFT+F10, gedit, откроется редактор реестра.

Shift+F10 \ regedit \ HKEY_LOCAL_MACHINE\SYSTEM\Setup \ ПКМ \ Создать new key \ Раздел \ LabConfig \ ПКМ \ Создать \ Параметр DWORD (32-bit) со значениями 1:
BypassTPMCheck – отключение проверки чипа
BypassSecureBootCheck – отключение проверки защищенной загрузки
BypassRAMCheck – отключение проверки объема оперативной памяти

Так же при установки WIN11 отрубить инет, иначе не даст создать локального пользователя.
И при попытке подклюсится нажать SHIFT+F10 и ввести OOBE\BYPASSNRO


Если настриваешь одноранговую сеть, то иногда надо сменить WORKGROUP на другую, так как по умолчанию она тупит и не забыть отключить общий лоступ с парольной защитой. Расшарить папку на всех и дать необходимые права.
Чтобы повысить безопасность можно не отключать общий доступ с парольной защитой, а создать одного одинакового пользователя с паролем  на всех компах в рабочей группе и расшарить папку только для него. Таким образом если кто-либо подключитя к рабочей группе, то он не сможет зайти в расшареную директорию, так как не будет знать имя и пароль.

Чтобы изменить пароль, запомненный для входа на сервер надо на рабочей станции зайти в Панель управления - юзеры - администрирование учетных записей.            
            
            
                    ACTIVE DIRECTORY


            Первоначальная установка и настройка AD
После установки нужно:
- в настройках сети (в трее network ans sharing center - ethernet0 - properties) поставить статический ip адрес (а не полученный от роутепа по DHCP) , маску и DNS замкнуть на себя (127.0.0.1)
- изменить имя компа (RMB my comp - properties)
- установить AD domain services
- В окошке после установки нажать Promote this server to a domain controller, создать новый лес (office.loc), далее далее и перезагрузка
- tools - DNS - создать запись для Reverse lookup zones


                Подключение рабочей станции к домену 
- настроить ip адрес на рабочих станциях, без шлюза,  с DNS - наш контроллер домена
- рабочие станции надо переименовать адекватно (например по должности сотрудника, а не по имени), так как если сотрудник уволится, то новый сотрудник будет сидеть за компом с именем старого сотрудника, а смена имени может повлечь проблемы.
- указать пункт "является членом домена" - office.loc в нашем примере
- появится окошко, надо ввсети пароль админа, для присоединения к домену

На сервере
- проверить присоединены ли компы к домену (tools - AD users and computers - computers)


                        Создание пользователей
Tools - AD Users and Accounts - выбрать свой домен - users - New -user
Лучше имя для входа делать общее в виде должности, чтобы после увольнения поменять только ФИО.

Как сменить политику паролей
Tools - Group policy management - Domains - office.loc - Default Domain Poicies - 
вкладка settings 
RMB - edit 
Computer conf - Policies - Windows settings - Security settings - Account policies - Password Policy
После изменений нужно обновить групповую политику командой gpupdate, или перегрузить сервер
Остановить обновления -диспетчер задач - службы - открыть службы - Windows Update (остановить и отключить)

                            Принтеры
После установки принтера надо зати в Панель управления - принтеры - выбрат свой принтер и нажать Свойстава принтера (не просто Свойства)
Во вкладке Sharing надо расшарить этот принтер и включить его в AD
Во вкладке Security разрешть все всем, чтобы в случае проблем с принтером любой пользователь мог отменить печать или подобное

Данный принтер появится во вкладке сеть у всех пользователей домена
Или на компе пользователя зайти в control panel - принтеры - добавить принтер - 

                            DHCP-сервер
Manage - add roles and feature - DHCP server - в конце установки появляется - настроить (далее.далее) 
После установки: Tools - DHCP - IPV4 (new scope)
После смены ip надо проверить на сервере в tools -dhcp какие адреса lease
И проверить в DNS обратную запись, если не обновилась, тогда открыть прямую запись и поставить галочку Update PTR record 


                            ЧТобы раздать интернет
Нужна вторая сетевая карта
Нужно установить службу Manage - add roles - Remote Access (это NAT и тд)
И далее выбрать Routing
Далее Tools - Routing and remote Access - выбрать свой сервер и  настроить

                            Групповая политика (ярлык)
Tools - Group policy managment - Default Domain Policy - Settings - ПКМ edit - User config - Preferences - Windows settings - Shortcuts

ВАЖНО:
- после настройки AD или до настройки нужно лишить дефолтного юзера на рабочих станциях админских прав но !!! сначала переименовать и включить дефолтную запись  админа, чтоюы можно было зайти на машину, если не работает контроллер домена

                            Группы (локальная, глобальная, универсальная)

Создаем глобальную группу безопасности и ставим членов группы

                            Создание сайта
Установить в ролях IIS сервер, добавить сайт в папку, прописать на DNS контроллера домена A запись

https://whatcms.org/ - определить движок сайта
similarweb.com - посмотреть траффик сайта, посещения и др статистику


                        Создание структуры организации (Unit)

AD Users and comp - domen - new Organization Unit (галочка на Protect object from accidental deletio)
Чтобы убрать галочку и удалить надо зайти в View - Advance features - выбрать юнит - свойства - Object (тут будет галочка)

Чтобы создать юзера, который сможет управлять как админ компами внутри данной организационной единицы нужно (чтобы например другой сисадмин из другого города мог управлять соим филиалом):
Нажать ПКМ на юните и Delegate control

Далее перетащить компы и пользователей в соответствующие юниты

К пользователям и компам могут применятся 2 типа политик : 
- локальные (во всех виндовс) - gpedit.msc
- доменные (только в AD) - Tools - group policy management - ... - Default domen policy

Создание новой гупповой политики: Group policy objects - ПКМ - new

        Предпочтения групповых политик

Переименовываем созданную на пред этапе политику так как нам надо, чтобы в будущем было понятно за что она отвечает. Мы хотим добавить на раб стол несколько значков. За них отвечают данные параметры реестра (программа regshoot)

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel]
"{59031a47-3f72-44a7-89c5-5595fe6b30ee}"=dword:00000000 - документы пользователя отображаются
"{20D04FE0-3AEA-1069-A2D8-08002B30309D}"=dword:00000000 - мой компьютер отображается
"{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}"=dword:00000000 - сеть отобржается
"{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}"=dword:00000000 - панель управления отображается

ПКМ - изменить
User configuration - Preferences - Windows settings - REgistry - ПКМ - new - registry item

Не забываем что есть targeting
Далее надо применить эту политику к домену
ПКМ на домене - Link an Existing GPO и выбрать нашу созданную политику

Так как если нажаьб ПКМ на новую политику и перейти на вкладку settings, то будет задействована только User Configuration, а Computer configuration - стоит No settings define, поэтому ее можно и нужно отключить, чтобы при применении данной политики комп не нагржался лишний раз


        Моделирование и результирующий набор политик

Моделирование
GPM - group policy modeling
Выбираем пользователя к которому будут применятся политики и на каком компе это будет - и таким образом она показывает какие политики будут применятся к этому пользователю на этом компе

Результирующя политика (Group policy resalts)
Показывает какие политики уже применены
Для того чтобы данная хрень работала надо добавить WMI (windows managment instrumentation) в исключения брандмауэра на той машине, на которой будем смотреть эту результирующую политику:
Панель управления - брандмауэр - вверху пункт Разрешить...

                Настройки брандмауэра

GPO - свой домен - create gpo and link
Edit - computer - policies - admin templates - network - network connections - firewall - domain profile - но тут мало пурктов настройки и они стандартные

... - policies - windows settings - secyrity settings - windows firewall with advance security - Inbound - ПКМ - create rule - 
Выбрать пункт predifined и там уже WMI (это для показа результирующей политики )

                Фильтры безопасмности и WMI

Можно использовать чтобы сначала применить политику не ко всем компам в домене и OU, а к какому то одному и потом уже, проверив что все хорошо, к остальным
ко ВСЕМ - ЭТО прошедште проверку

Создаем политику (вместо прошедших проверку добавляем компы и юзеров) и потом создвем фильтр WMI
Затем в политикке - scope - добавляем фильтр и связываем политику с доменом

                Общие сетевые ресурсы

Создаем папку на сервере которая в которую будем складывать все ярлыки для отображения на рабочих станциях
Создаем там папку Обмен
Создаем ярлык для программы (2гис), но путь до исполняемого файла должен быть сетевой и папка с установленной программой расшарена для чтения для Everyone!
Создаем политику и создаем папку на диске c (путь обычный)
Создаем ярлыки в этой папке, которые ссылаются на сетевой путь

            Скрипты

Создвем политику - comp config - policies - windows settings - scripts - show files - тут должны лежать фалы скриптов - выбрать нужный скрипт нажав add

            Удаленный рабочий стол

Создаем политику компа - policies - adm templtes - win components - RDP services - RDP session host - connections
Тут вкл параметр Aloow user to connect remoutly using RDP
- security
ТУт Allow user autentication .... (disable)

Далее открыть порт в брандмауэре
Тоже политика компа - policies - adm templates - network - net connections - win firewall - domain profile 
Тут вкл Allow inbound RDP exceptions
Слева можно указать с каких ip разрешено подключение. * - с любых

Далее откоючаем спящий режим
Тоже политика компа - policies - adm templates - system - power management - sleep settings
Тут вкл specify the system sleep timeout (plugged in) - 0
И specify the unattended sleep timeout (plugged in) - 0

        УДАЛЕННЫЙ ПОМОЩНИК (нет на сервере!)

Выполнить: msra - удаленный помощник
Тот кому надо помощь создает файл приглашения и помещает ее в общую папку или отправить по интернету + сообщает код доступа
ТО кто помогает открвает приглашение, вводит код и может видеть рабочий стол, чтоюы управлять надо отправить еще один запрос

Пользоваться данной штукой можно без создания файла приглашения, но только по локальной сети!
GPO - COmputer - policies - adm templates - system - remote assistance
COnfigure solicited remote assistance
COnfigure offer remote assistance - enable и указать кто может (office\Administrator)

Теперь с рабочей станции (не с сервера) можно нажать RUN и msra /offerra (с того пользователя который разрешен в политиках)
Можно скопировать данную команду и создать ярлык
Прога  BGinfo для отображения инфы о компе на рабочем столе 




